import pandas as pd
import numpy as np
import pandas_datareader as dr


def softmax(x):
    """Compute softmax values for each sets of scores in x."""
    return np.exp(x) / np.sum(np.exp(x), axis=0)
day = '2019-10-02'
tickers = ['AAPL', 'AXP', 'BA', 'CAT', 'CSCO', 'CVX', 'DIS', 'GS', 'HD', 'IBM', 'INTC', 'JNJ', 'JPM', 'KO', 'MCD', 'MMM', 'MRK', 'MSFT', 'NKE', 'PFE', 'PG', 'TRV', 'UNH', 'V', 'VZ', 'WBA', 'WMT', 'XOM']
rets = pd.Series([-0.014229110731044171, -0.015364818981689492, -0.016386232944043667, -0.013376504931063389, -0.02045143854240294, -0.013181590674958239, -0.011184412115872866, -0.012286477634447047, -0.015488882482471095, -0.016321154085811695, -0.01740382773529333, -0.010349513673295023, -0.009281042945570347, -0.011393456794019324, -0.009898134966532326, -0.017171167473417653, -0.011956099527086744, -0.014469973282474657, -0.0137962076974184, -0.013546501557688335, -0.01356667185683433, -0.011545675704908775, -0.011509114721540288, -0.01113516399214566, -0.008399774570199338, -0.02251776159012775, -0.008421255155692885, -0.014768965249368708])
rets = rets*-1

prices = []
for ticker in tickers:
    prices.append(dr.DataReader(ticker, start=day, end=day, data_source='yahoo').iloc[0]['Open'])

print(prices)
rets = rets*(prices)
sm = softmax(rets)

# print(sum(sm))



weights = {}
for i in range(len(tickers)):
    weights[tickers[i]] = sm[i]

print(weights)

# print(sum([0.0397613  0.0393735  0.03980452 0.03977953 0.0395799  0.04134479 0.03987614 0.04014331 0.04011583 0.04033163 0.03959258 0.0407105
#  0.04080923 0.04102088 0.03998806 0.04049296 0.03954083 0.03915228
#  0.03978702 0.03962716 0.04002839 0.03990282 0.04005299 0.03944732
#  0.03973653]))